name: Java Maven Selenium CI

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build:
    runs-on: ubuntu-24.04

    steps:
    - name: Checkout repository
      uses: actions/checkout@v3

    # Update APT and install dependencies
    - name: Install dependencies
      run: |
        sudo apt-get update
        sudo apt-get install -y \
          openjdk-17-jdk \
          maven \
          unzip \
          wget \
          xvfb \
          libnss3 \
          libnspr4 \
          libxss1 \
          libgconf-2-4 || true  # fallback for older packages

    # Install Google Chrome
    - name: Install Google Chrome
      run: |
        wget -qO- https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb > chrome.deb
        sudo apt install -y ./chrome.deb
        google-chrome --version

    # Set up ChromeDriver matching Chrome
    - name: Setup ChromeDriver
      uses: nanasess/setup-chromedriver@v2
      with:
        chrome-version: stable

    # Display versions for debug
    - name: Display Chrome & ChromeDriver versions
      run: |
        google-chrome --version
        chromedriver --version

    # Run Maven build and tests
    - name: Build with Maven
      run: mvn clean install -B
